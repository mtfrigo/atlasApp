<ion-header>
  <ion-navbar>
    <ion-title>
      Atlas
    </ion-title>
  </ion-navbar>
</ion-header>

<ion-content padding>
  <ion-item *ngIf="list_uf.length">
    <ion-label>Estados</ion-label>
    <ion-select [(ngModel)]="parameters.uf">
        <ion-option *ngFor="let state of list_uf" [value]="state.id">{{state.name}}</ion-option>
    </ion-select>
  </ion-item>

  <ion-item *ngIf="ready_pt_br">
    <ion-label>Variável</ion-label>
    <ion-select [(ngModel)]="parameters.var" (ngModelChange)="update($event)">
        <ion-option *ngFor="let variable of pt_br.var[parameters.eixo]" [value]="variable.id">{{variable.title}}</ion-option>
    </ion-select>
  </ion-item>

  <ion-item *ngIf="parameters.ano > 0">
    <ion-label>Ano</ion-label>
    <ion-select [(ngModel)]="parameters.ano">
        <ion-option *ngFor="let ano of anos[parameters.var][parameters.slc].reverse()" [value]="ano">{{ano}}</ion-option>
    </ion-select>
  </ion-item>

  <ion-item *ngIf="parameters.cad != null">
    <ion-label>Cadeia</ion-label>
    <ion-select [(ngModel)]="parameters.cad">
        <ion-option *ngFor="let cad of cads" [value]="cad.value">{{cad.name}}</ion-option>
    </ion-select>
  </ion-item>

  <ion-item *ngIf="parameters.eixo == 0 && vrvPorte()">
    <ion-label>Desagregação</ion-label>
    <ion-select [(ngModel)]="parameters.deg">
      <ion-option *ngFor="let porte of portes" [value]="porte.value">{{porte.name}}</ion-option>
    </ion-select>
  </ion-item>

  <ion-item *ngIf="parameters.eixo == 1">
    <ion-label>Desagregação</ion-label>
    <ion-select [(ngModel)]="pre_desags" (ngModelChange)="updateDesag($event)">
      <ion-option *ngFor="let desag of select_desags" [value]="desag.value" [disabled]="desag.group_name">{{desag.name}}</ion-option>
    </ion-select>
  </ion-item>

  <ion-item *ngIf="parameters.eixo == 3">
    <ion-label>Parceiro</ion-label>
    <ion-select [(ngModel)]="parameters.prc">
      <ion-option *ngFor="let prc of parceiros" [value]="prc.value">{{prc.name}}</ion-option>
    </ion-select>
  </ion-item>

  <ion-item *ngIf="parameters.eixo == 3">
    <ion-label>Tipo</ion-label>
    <ion-select [(ngModel)]="parameters.typ">
      <ion-option *ngFor="let typ of selectTipos()" [value]="typ.value">{{typ.name}}</ion-option>
    </ion-select>
  </ion-item>

  <view-dados *ngIf="parameters.ano > 0" [parameters]="parameters" [url]="getQuery(parameters)"></view-dados>
  <hr>

  
  <ion-item *ngIf="parameters.ano > 0 && ready_pt_br">
      <div>
          <view-mapa *ngIf="correctView(1, 'mapa')" [url]="getQuery(parameters)" [parameters]="parameters"></view-mapa>
          <view-barras *ngIf="correctView(1, 'barras')" [url]="getQuery(parameters)" [parameters]="parameters"></view-barras>
        </div>
      <div>
        <view-barras *ngIf="correctView(2, 'barras')" [url]="getQuery(parameters)" [parameters]="parameters"></view-barras>
        <view-treemap *ngIf="correctView(2, 'treemap_scc')" [url]="getQuery(parameters)" [parameters]="parameters"></view-treemap>
        <view-donut *ngIf="correctView(2, 'donut')" [url]="getQuery(parameters)" [parameters]="parameters"></view-donut>
      </div>
      
      <div>
        <view-barras *ngIf="correctView(3, 'barras')" [url]="getQuery(parameters)" [parameters]="parameters"></view-barras>
        <view-treemap *ngIf="correctView(3, 'treemap_scc')" [url]="getQuery(parameters)" [parameters]="parameters"></view-treemap>
      </div>
        
  </ion-item>
  <hr>
  


</ion-content>
